<!DOCTYPE html>
<!-- saved from url=(0085)https://databricks.com/blog/2015/07/15/introducing-window-functions-in-spark-sql.html -->
<html lang="en-US" prefix="og: http://ogp.me/ns# fb: http://ogp.me/ns/fb# article: http://ogp.me/ns/article#" class=""><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><script async="" id="db_ip_api" src="./Introducing Window Functions in Spark SQL_files/ip.json"></script><script async="" src="https://connect.facebook.net/en_US/fbevents.js"></script><script id="hs-analytics" src="./Introducing Window Functions in Spark SQL_files/438089.js"></script><script async="" id="demandbase_js_lib" src="./Introducing Window Functions in Spark SQL_files/xoRL8eto.min.js"></script><script type="text/javascript" async="" src="./Introducing Window Functions in Spark SQL_files/conversion_async.js"></script><script async="" src="./Introducing Window Functions in Spark SQL_files/v2.js"></script>
  
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge"><script async="" src="./Introducing Window Functions in Spark SQL_files/gtm.js"></script><script async="" src="./Introducing Window Functions in Spark SQL_files/analytics.js"></script><script type="text/javascript">window.NREUM||(NREUM={}),__nr_require=function(e,t,n){function r(n){if(!t[n]){var o=t[n]={exports:{}};e[n][0].call(o.exports,function(t){var o=e[n][1][t];return r(o||t)},o,o.exports)}return t[n].exports}if("function"==typeof __nr_require)return __nr_require;for(var o=0;o<n.length;o++)r(n[o]);return r}({1:[function(e,t,n){function r(e,t){return function(){o(e,[(new Date).getTime()].concat(a(arguments)),null,t)}}var o=e("handle"),i=e(2),a=e(3);"undefined"==typeof window.newrelic&&(newrelic=NREUM);var u=["setPageViewName","addPageAction","setCustomAttribute","finished","addToTrace","inlineHit"],c=["addPageAction"],f="api-";i(u,function(e,t){newrelic[t]=r(f+t,"api")}),i(c,function(e,t){newrelic[t]=r(f+t)}),t.exports=newrelic,newrelic.noticeError=function(e){"string"==typeof e&&(e=new Error(e)),o("err",[e,(new Date).getTime()])}},{}],2:[function(e,t,n){function r(e,t){var n=[],r="",i=0;for(r in e)o.call(e,r)&&(n[i]=t(r,e[r]),i+=1);return n}var o=Object.prototype.hasOwnProperty;t.exports=r},{}],3:[function(e,t,n){function r(e,t,n){t||(t=0),"undefined"==typeof n&&(n=e?e.length:0);for(var r=-1,o=n-t||0,i=Array(0>o?0:o);++r<o;)i[r]=e[t+r];return i}t.exports=r},{}],ee:[function(e,t,n){function r(){}function o(e){function t(e){return e&&e instanceof r?e:e?u(e,a,i):i()}function n(n,r,o){e&&e(n,r,o);for(var i=t(o),a=l(n),u=a.length,c=0;u>c;c++)a[c].apply(i,r);var s=f[g[n]];return s&&s.push([m,n,r,i]),i}function p(e,t){w[e]=l(e).concat(t)}function l(e){return w[e]||[]}function d(e){return s[e]=s[e]||o(n)}function v(e,t){c(e,function(e,n){t=t||"feature",g[n]=t,t in f||(f[t]=[])})}var w={},g={},m={on:p,emit:n,get:d,listeners:l,context:t,buffer:v};return m}function i(){return new r}var a="nr@context",u=e("gos"),c=e(2),f={},s={},p=t.exports=o();p.backlog=f},{}],gos:[function(e,t,n){function r(e,t,n){if(o.call(e,t))return e[t];var r=n();if(Object.defineProperty&&Object.keys)try{return Object.defineProperty(e,t,{value:r,writable:!0,enumerable:!1}),r}catch(i){}return e[t]=r,r}var o=Object.prototype.hasOwnProperty;t.exports=r},{}],handle:[function(e,t,n){function r(e,t,n,r){o.buffer([e],r),o.emit(e,t,n)}var o=e("ee").get("handle");t.exports=r,r.ee=o},{}],id:[function(e,t,n){function r(e){var t=typeof e;return!e||"object"!==t&&"function"!==t?-1:e===window?0:a(e,i,function(){return o++})}var o=1,i="nr@id",a=e("gos");t.exports=r},{}],loader:[function(e,t,n){function r(){if(!w++){var e=v.info=NREUM.info,t=s.getElementsByTagName("script")[0];if(e&&e.licenseKey&&e.applicationID&&t){c(l,function(t,n){e[t]||(e[t]=n)});var n="https"===p.split(":")[0]||e.sslForHttp;v.proto=n?"https://":"http://",u("mark",["onload",a()],null,"api");var r=s.createElement("script");r.src=v.proto+e.agent,t.parentNode.insertBefore(r,t)}}}function o(){"complete"===s.readyState&&i()}function i(){u("mark",["domContent",a()],null,"api")}function a(){return(new Date).getTime()}var u=e("handle"),c=e(2),f=window,s=f.document;NREUM.o={ST:setTimeout,XHR:f.XMLHttpRequest,REQ:f.Request,EV:f.Event,PR:f.Promise,MO:f.MutationObserver},e(1);var p=(""+location).split("?")[0],l={beacon:"bam.nr-data.net",errorBeacon:"bam.nr-data.net",agent:"js-agent.newrelic.com/nr-892.min.js"},d=window.XMLHttpRequest&&XMLHttpRequest.prototype&&XMLHttpRequest.prototype.addEventListener&&!/CriOS/.test(navigator.userAgent),v=t.exports={offset:a(),origin:p,features:{},xhrWrappable:d};s.addEventListener?(s.addEventListener("DOMContentLoaded",i,!1),f.addEventListener("load",r,!1)):(s.attachEvent("onreadystatechange",o),f.attachEvent("onload",r)),u("mark",["firstbyte",a()],null,"api");var w=0},{}]},{},["loader"]);</script>
<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">

<title>Introducing Window Functions in Spark SQL</title>

<link rel="profile" href="http://gmpg.org/xfn/11">
<link rel="pingback" href="https://databricks.com/xmlrpc.php">
<link rel="mask-icon" href="https://databricks.com/mask-icon.svg" color="#FD3A1C">
<link rel="apple-touch-icon" sizes="57x57" href="https://databricks.com/apple-touch-icon-57x57.png">
<link rel="apple-touch-icon" sizes="60x60" href="https://databricks.com/apple-touch-icon-60x60.png">
<link rel="apple-touch-icon" sizes="72x72" href="https://databricks.com/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="76x76" href="https://databricks.com/apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" sizes="114x114" href="https://databricks.com/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="120x120" href="https://databricks.com/apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" sizes="144x144" href="https://databricks.com/apple-touch-icon-144x144.png">
<link rel="apple-touch-icon" sizes="152x152" href="https://databricks.com/apple-touch-icon-152x152.png">
<link rel="apple-touch-icon" sizes="180x180" href="https://databricks.com/apple-touch-icon-180x180.png">
<link rel="icon" type="image/png" href="https://databricks.com/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="https://databricks.com/android-chrome-192x192.png" sizes="192x192">
<link rel="icon" type="image/png" href="https://databricks.com/favicon-96x96.png" sizes="96x96">
<link rel="icon" type="image/png" href="https://databricks.com/favicon-16x16.png" sizes="16x16">
<link rel="manifest" href="https://databricks.com/manifest.json">
<meta name="msapplication-TileColor" content="#ffffff">
<meta name="msapplication-TileImage" content="/mstile-144x144.png">
<meta name="theme-color" content="#ffffff">


<!-- SEO Ultimate (http://www.seodesignsolutions.com/wordpress-seo/) -->
	<meta name="description" content="In this blog post, we introduce the new window function feature that was added in Spark 1.4.">
	<meta property="og:type" content="article">
	<meta property="og:title" content="Introducing Window Functions in Spark SQL">
	<meta property="og:description" content="In this blog post, we introduce the new window function feature that was added in Spark 1.4.">
	<meta property="og:url" content="https://databricks.com/blog/2015/07/15/introducing-window-functions-in-spark-sql.html">
	<meta property="og:image" content="https://databricks.com/wp-content/themes/databricks/assets/images/databricks_logo_large.png">
	<meta property="article:published_time" content="2015-07-15">
	<meta property="article:modified_time" content="2015-07-15">
	<meta property="article:author" content="https://databricks.com/blog/author/michael">
	<meta property="article:tag" content="All Posts">
	<meta property="article:tag" content="Developer Blog">
	<meta property="article:tag" content="Spark">
	<meta property="article:tag" content="Spark SQL">
	<meta property="og:site_name" content="Databricks">
	<meta name="twitter:card" content="summary">
	<meta name="twitter:site" content="@databricks">
	<meta name="twitter:site:id" content="1562518867">
	<meta name="msvalidate.01" content="C31D3542BF61D435F8F05FDCE3F423EA">

<!-- Code Inserter module -->
<!-- hello -->
<!-- /Code Inserter module -->

<!-- /SEO Ultimate -->

<link rel="stylesheet" id="databricks-css-bootstrap-css" href="./Introducing Window Functions in Spark SQL_files/bootstrap.min.css" type="text/css" media="all">
<link rel="stylesheet" id="databricks-css-fancybox-css" href="./Introducing Window Functions in Spark SQL_files/jquery.fancybox.css" type="text/css" media="all">
<link rel="stylesheet" id="databricks-css-main-css" href="./Introducing Window Functions in Spark SQL_files/main.css" type="text/css" media="all">
<link rel="https://api.w.org/" href="https://databricks.com/wp-json/">
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://databricks.com/xmlrpc.php?rsd">
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://databricks.com/wp-includes/wlwmanifest.xml"> 
<link rel="prev" title="Introducing R Notebooks in Databricks" href="https://databricks.com/blog/2015/07/13/introducing-r-notebooks-in-databricks.html">
<link rel="next" title="Joint Blog Post: Bringing ORC Support into Apache Spark" href="https://databricks.com/blog/2015/07/16/joint-blog-post-bringing-orc-support-into-apache-spark.html">
<meta name="generator" content="WordPress 4.4.2">
<link rel="canonical" href="./Introducing Window Functions in Spark SQL_files/Introducing Window Functions in Spark SQL.html">
<link rel="shortlink" href="https://databricks.com/?p=4569">
<link rel="alternate" type="application/json+oembed" href="https://databricks.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fdatabricks.com%2Fblog%2F2015%2F07%2F15%2Fintroducing-window-functions-in-spark-sql.html">
<link rel="alternate" type="text/xml+oembed" href="https://databricks.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fdatabricks.com%2Fblog%2F2015%2F07%2F15%2Fintroducing-window-functions-in-spark-sql.html&amp;format=xml">
<style type="text/css" id="syntaxhighlighteranchor"></style>
<!-- Google Analytics Tracking by Google Analyticator 6.4.9: http://www.videousermanuals.com/google-analyticator/ -->
<script type="text/javascript">
    var analyticsFileTypes = [''];
    var analyticsSnippet = 'disabled';
    var analyticsEventTracking = 'enabled';
</script>
<script type="text/javascript">
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','//www.google-analytics.com/analytics.js','ga');
	ga('create', 'UA-44077918-1', 'auto');
	ga('send', 'pageview');
</script>
<style type="text/css">.fancybox-margin{margin-right:14px;}</style></head>
<body class="single single-post postid-4569 single-format-standard  in-blog loaded has-email-tab-component">
  <div class="body-header">
  <nav class="body-header--navbar navbar navbar-fixed-top">
    <div class="body-header--navbar-container container">
      <div class="body-header--navbar-header">
        <div class="body-header--navbar-header--brand">          <a href="https://databricks.com/">
            <span class="sr-only">Databricks, Inc</span>
          </a>
        </div>
        <button type="button" class="body-header--navbar-header--toggle body-header--navbar-toggle--mobile-menu js-toggle-mobile-header-menu">
          <span class="db-icon-menu"></span>
          <span class="sr-only">Toggle navigation</span>
        </button>
      </div>

      <div class="body-header--navbar-menu js-mobile-header-menu">
        <div class="body-header--navbar-menu--inner">
          <div class="body-header--navbar-menu--mobile-search">
            <div class="snippet_search_form">
<form class="form form-search" action="https://databricks.com/" method="get">
    <div class="form-group">
    <label class="form-search-label" for="search-1">Search</label>
    <input class="form-search-field form-control" type="text" name="s" id="search-1" placeholder="Search">
  </div>
  <button class="form-search-submit btn" type="submit">
    <span class="form-search-submit-text">Search</span>
  </button>
</form>
</div>          </div>

          <ul class="nav body-header--navbar-menu--menu body-header--navbar-menu--menu-left allow-dropdown-hover">
            <li class="body-header--navbar-menu--signup-link visible-xs menu-item">
              <a href="https://accounts.cloud.databricks.com/registration.html#signup" aria-label="Sign up for Databricks">Sign Up <span class="sr-only">for Databricks</span></a>
            </li>

            <li id="menu-item-2322" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-2322 dropdown"><a href="https://databricks.com/product/databricks" data-toggle="dropdown" class="dropdown-toggle" aria-haspopup="true">Product <span class="caret"></span></a>
<ul role="menu" class=" dropdown-menu">
	<li id="menu-item-31" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-31"><a href="https://databricks.com/product/databricks">Databricks</a></li>
	<li id="menu-item-5851" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-5851"><a href="https://databricks.com/product/pricing">Pricing</a></li>
	<li id="menu-item-4871" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4871"><a href="https://databricks.com/product/security">Security</a></li>
	<li id="menu-item-30" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-30"><a href="https://databricks.com/product/faq">FAQ</a></li>
	<li id="menu-item-4032" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-4032"><a href="https://forums.databricks.com/">Forums</a></li>
	<li id="menu-item-4839" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4839"><a href="https://databricks.com/academic">Academic Program</a></li>
</ul>
</li>
<li id="menu-item-145" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-145 dropdown"><a href="https://databricks.com/spark/about" data-toggle="dropdown" class="dropdown-toggle" aria-haspopup="true">Spark <span class="caret"></span></a>
<ul role="menu" class=" dropdown-menu">
	<li id="menu-item-147" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-147"><a href="https://databricks.com/spark/about">About Spark</a></li>
	<li id="menu-item-4688" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-4688"><a href="http://sparkhub.databricks.com/">SparkHub (Community)</a></li>
	<li id="menu-item-2169" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2169"><a href="https://databricks.com/spark/developer-resources">Developer Resources</a></li>
	<li id="menu-item-172" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-172"><a href="https://databricks.com/spark/certification">Certification</a></li>
	<li id="menu-item-261" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-261"><a href="https://databricks.com/spark/training">Training</a></li>
</ul>
</li>
<li id="menu-item-4064" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-4064 dropdown"><a href="https://databricks.com/solutions/by-role" data-toggle="dropdown" class="dropdown-toggle" aria-haspopup="true">Solutions <span class="caret"></span></a>
<ul role="menu" class=" dropdown-menu">
	<li id="menu-item-4066" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4066"><a href="https://databricks.com/solutions/by-role">By Role</a></li>
	<li id="menu-item-4065" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4065"><a href="https://databricks.com/solutions/by-industry">By Industry</a></li>
	<li id="menu-item-4067" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4067"><a href="https://databricks.com/solutions/by-use-case">By Use Case</a></li>
</ul>
</li>
<li id="menu-item-5441" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-5441"><a href="https://databricks.com/customers">Customers</a></li>
<li id="menu-item-256" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-256 dropdown"><a href="https://databricks.com/company/about-us" data-toggle="dropdown" class="dropdown-toggle" aria-haspopup="true">Company <span class="caret"></span></a>
<ul role="menu" class=" dropdown-menu">
	<li id="menu-item-258" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-258"><a href="https://databricks.com/company/about-us">About Us</a></li>
	<li id="menu-item-6055" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-6055"><a href="https://databricks.com/company/leadership-team">Leadership</a></li>
	<li id="menu-item-2109" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2109"><a href="https://databricks.com/company/team">Team</a></li>
	<li id="menu-item-5835" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-5835"><a href="https://databricks.com/company/partners">Partners</a></li>
	<li id="menu-item-3811" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-3811"><a href="https://databricks.com/company/newsroom">Newsroom</a></li>
	<li id="menu-item-4249" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4249"><a href="https://databricks.com/company/careers">Careers</a></li>
	<li id="menu-item-260" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-260"><a href="https://databricks.com/company/contact">Contact</a></li>
</ul>
</li>
<li id="menu-item-217" class="menu-item menu-item-type-post_type menu-item-object-page current_page_parent menu-item-217"><a href="https://databricks.com/blog">Blog</a></li>
<li id="menu-item-4081" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-4081 dropdown"><a href="https://databricks.com/resources/analyst-reports" data-toggle="dropdown" class="dropdown-toggle" aria-haspopup="true">Resources <span class="caret"></span></a>
<ul role="menu" class=" dropdown-menu">
	<li id="menu-item-4159" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4159"><a href="https://databricks.com/resources/analyst-reports">Analyst Reports</a></li>
	<li id="menu-item-4082" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4082"><a href="https://databricks.com/resources/briefs">Briefs</a></li>
	<li id="menu-item-4083" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4083"><a href="https://databricks.com/resources/case-studies">Case Studies</a></li>
	<li id="menu-item-4084" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4084"><a href="https://databricks.com/resources/newsletters">Newsletters</a></li>
	<li id="menu-item-5477" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-5477"><a href="https://databricks.com/resources/selected-notebooks">Selected Notebooks</a></li>
	<li id="menu-item-4085" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4085"><a href="https://databricks.com/resources/slides">Slides</a></li>
	<li id="menu-item-5210" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-5210"><a href="https://databricks.com/resources/surveys">Surveys</a></li>
	<li id="menu-item-4086" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4086"><a href="https://databricks.com/resources/videos">Videos</a></li>
	<li id="menu-item-4777" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4777"><a href="https://databricks.com/resources/webinars">Webinars</a></li>
</ul>
</li>
          </ul>

          <ul class="nav body-header--navbar-menu--menu body-header--navbar-menu--menu-right allow-dropdown-hover">
            <li id="menu-item-5836" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-5836"><a href="https://databricks.com/company/partners">Partners</a></li>
<li id="menu-item-4034" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4034"><a href="https://databricks.com/spark/training">Training</a></li>

            <li class="body-header--navbar-menu--signup-link hidden-xs menu-item sm-keep">
              <a href="https://accounts.cloud.databricks.com/registration.html#signup" aria-label="Sign up for Databricks">Sign Up <span class="sr-only">for Databricks</span></a>
            </li>

            <li class="menu-item body-header--navbar-menu--desktop-search sm-keep">
              <a href="https://databricks.com/blog/2015/07/15/introducing-window-functions-in-spark-sql.html#" data-toggle="collapse" data-target="#body-header-desktop-search-collapse" title="Search" class="body-header--navbar-menu--desktop-search-toggle collapsed">
                <span class="db-icon-search"></span>
                <span class="sr-only">Toggle Search</span>
              </a>

              <div id="body-header-desktop-search-collapse" class="body-header--navbar-menu--desktop-search-form collapse js-desktop-search-collapse">
                <div class="snippet_search_form">
<form class="form form-search" action="https://databricks.com/" method="get">
    <div class="form-group">
    <label class="form-search-label" for="search-2">Search</label>
    <input class="form-search-field form-control" type="text" name="s" id="search-2" placeholder="Search">
  </div>
  <button class="form-search-submit btn" type="submit">
    <span class="form-search-submit-text">Search</span>
  </button>
</form>
</div>              </div>
            </li>
          </ul>
        </div>
      </div>
    </div>
  </nav>

  <div class="body-header--mobile-navbar-overlay js-toggle-mobile-header-menu"></div>
</div><!-- .body-header -->
<div class="body-content">
<div class="page-container container">
<div class="page-section">
  <div class="row row-rtl">
    <div class="visible-lg col-lg-2"><!-- spacer --></div>

    <div class="col-main col-sm-9 col-lg-8">
            <div class="blog-content l-formatted">
                
  <div class="blog-post blog-post-single">
        <div class="blog-post-category-bar color-orange"></div>

        <div class="blog-post-avatars hidden-xs avatar-grid-2x1">
            <div class="avatar-grid-item">
        <img src="./Introducing Window Functions in Spark SQL_files/yinH-150x150.jpg" width="150" height="150" class="avatar avatar-150 wp-user-avatar wp-user-avatar-150 photo" alt="Yin Huai">      </div>
            <div class="avatar-grid-item">
        <img src="./Introducing Window Functions in Spark SQL_files/michaelA-150x150.jpg" width="150" height="150" alt="Michael Armbrust" class="avatar avatar-150 wp-user-avatar wp-user-avatar-150 alignnone photo">      </div>
          </div>

    <header class="blog-post-header">
              <h1 class="blog-post-title">Introducing Window Functions in Spark SQL</h1>
      
      <div class="blog-post-meta">
        <span class="blog-post-meta-item meta-item-date">July 15, 2015</span>
        <span class="blog-post-meta-item meta-item-author">by Yin Huai and Michael Armbrust</span>
      </div>

              <div class="blog-post-tags">
                  </div>

        <ul class="blog-post-share navbar-share">
          <li>
            <a href="https://twitter.com/home?status=https://databricks.com/blog/2015/07/15/introducing-window-functions-in-spark-sql.html" class="twitter" target="_blank">
              <span class="db-icon-twitter"></span>
              <span class="sr-only">Share article on Twitter</span>
            </a>
          </li>
          <li>
            <a href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https://databricks.com/blog/2015/07/15/introducing-window-functions-in-spark-sql.html&amp;title=Introducing%20Window%20Functions%20in%20Spark%20SQL&amp;summary=&amp;source=" class="linkedin" target="_blank">
              <span class="db-icon-linkedin"></span>
              <span class="sr-only">Share article on LinkedIn</span>
            </a>
          </li>
          <li>
            <a href="https://www.facebook.com/sharer/sharer.php?u=https://databricks.com/blog/2015/07/15/introducing-window-functions-in-spark-sql.html" class="facebook" target="_blank">
              <span class="db-icon-facebook"></span>
              <span class="sr-only">Share article on Facebook</span>
            </a>
          </li>
        </ul>
          </header>

    <div class="blog-post-article">
      <p>In this blog post, we introduce the new window function feature that was added in <a href="https://databricks.com/blog/2015/06/11/announcing-apache-spark-1-4.html">Spark 1.4</a>. Window functions allow users of Spark SQL to calculate results such as the rank of a given row or a moving average over a range of input rows. They significantly improve the expressiveness of Spark’s SQL and DataFrame APIs. This blog will first introduce the concept of window functions and then discuss how to use them with Spark SQL and Spark’s DataFrame API.</p>
<h2>What are Window Functions?</h2>
<p>Before 1.4, there were two kinds of functions supported by Spark SQL that could be used to calculate a single return value. <i>Built-in functions</i> or <i>UDFs</i>, such as&nbsp;<code>substr</code> or&nbsp;<code>round</code>, take values from a single row as input, and they generate a single return value for every input row. <i>Aggregate functions, </i>such as <code>SUM</code> or <code>MAX</code><i>,</i> operate on a group of rows and calculate a single return value for every group.</p>
<p>While these are both very useful in practice, there is still a wide range of operations that cannot be expressed using these types of functions alone. Specifically, there was no way to both operate on a group of rows while still returning a single value for every input row. This limitation makes it hard to conduct various data processing tasks like calculating a moving average, calculating a cumulative sum, or accessing the values of a row appearing before the current row. Fortunately for users of Spark SQL, window functions fill this gap.</p>
<p>At its core, a window function calculates a return value for every input row of a table based on a group of rows, called the <i>Frame</i>. Every input row can have a unique frame associated with it. This characteristic of window functions makes them more powerful than other functions and allows users to express various data processing tasks that are hard (if not impossible) to be expressed without window functions in a concise way. Now, let’s take a look at two examples.</p>
<p>Suppose that we have a <i>productRevenue</i> table as shown below.</p>
<p><img class="aligncenter wp-image-4572" src="./Introducing Window Functions in Spark SQL_files/1-1.png" alt="1-1" width="300" height="353"></p>
<p>We want to answer two questions:</p>
<ol>
<li>What are the best-selling and the second best-selling products in every category?</li>
<li>What is the difference between the revenue of each product and the revenue of the best-selling product in the same category of that product?</li>
</ol>
<p>To answer the first question “<i>What are the best-selling and the second best-selling products in every category?</i>”, we need to rank products in a category based on their revenue, and to pick the best selling and the second best-selling products based the ranking. Below is the SQL query used to answer this question by using window function <code>dense_rank</code> (we will explain the syntax of using window functions in next section).</p>
<div style="background: #f8f8f8; overflow: auto; width: auto;">
<pre style="margin: 0; line-height: 125%;"><span style="color: #aa22ff; font-weight: bold;">SELECT</span>
  product,
  category,
  revenue
<span style="color: #aa22ff; font-weight: bold;">FROM</span> (
  <span style="color: #aa22ff; font-weight: bold;">SELECT</span>
    product,
    category,
    revenue,
    dense_rank() OVER (PARTITION <span style="color: #aa22ff; font-weight: bold;">BY</span> category <span style="color: #aa22ff; font-weight: bold;">ORDER</span> <span style="color: #aa22ff; font-weight: bold;">BY</span> revenue <span style="color: #aa22ff; font-weight: bold;">DESC</span>) <span style="color: #aa22ff; font-weight: bold;">as</span> rank
  <span style="color: #aa22ff; font-weight: bold;">FROM</span> productRevenue) tmp
<span style="color: #aa22ff; font-weight: bold;">WHERE</span>
  rank <span style="color: #666666;">&lt;=</span> <span style="color: #666666;">2</span>
</pre>
</div>
<p>&nbsp;</p>
<p>The result of this query is shown below. Without using window functions, it is very hard to express the query in SQL, and even if a SQL query can be expressed, it is hard for the underlying engine to efficiently evaluate the query.</p>
<p><img class=" wp-image-4574 aligncenter" src="./Introducing Window Functions in Spark SQL_files/1-2.png" alt="1-2" width="300" height="184"></p>
<p>For the second question “<i>What is the difference between the revenue of each product and the revenue of the best selling product in the same category as that product?</i>”, to calculate the revenue difference for a product, we need to find the highest revenue value from products in the same category for each product. Below is a Python DataFrame program used to answer this question.</p>
<div style="background: #f8f8f8; overflow: auto; width: auto;">
<pre style="margin: 0; line-height: 125%;">import sys
<span style="color: #aa22ff; font-weight: bold;">from</span> pyspark.<span style="color: #aa22ff; font-weight: bold;">sql</span>.window import Window
import pyspark.<span style="color: #aa22ff; font-weight: bold;">sql</span>.functions <span style="color: #aa22ff; font-weight: bold;">as</span> func

windowSpec <span style="color: #666666;">=</span> \
  Window 
    .partitionBy(df[<span style="color: #bb4444;">'category'</span>]) \
    .orderBy(df[<span style="color: #bb4444;">'revenue'</span>].<span style="color: #aa22ff; font-weight: bold;">desc</span>()) \
    .rangeBetween(<span style="color: #666666;">-</span>sys.maxsize, sys.maxsize)
dataFrame <span style="color: #666666;">=</span> sqlContext.<span style="color: #aa22ff; font-weight: bold;">table</span>(<span style="color: #b8860b;">"productRevenue"</span>)
revenue_difference <span style="color: #666666;">=</span> \
  (func.<span style="color: #aa22ff; font-weight: bold;">max</span>(dataFrame[<span style="color: #bb4444;">'revenue'</span>]).over(windowSpec) <span style="color: #666666;">-</span> dataFrame[<span style="color: #bb4444;">'revenue'</span>])
dataFrame.<span style="color: #aa22ff; font-weight: bold;">select</span>(
  dataFrame[<span style="color: #bb4444;">'product'</span>],
  dataFrame[<span style="color: #bb4444;">'category'</span>],
  dataFrame[<span style="color: #bb4444;">'revenue'</span>],
  revenue_difference.<span style="color: #aa22ff; font-weight: bold;">alias</span>(<span style="color: #b8860b;">"revenue_difference"</span>))
</pre>
</div>
<p>&nbsp;</p>
<p>The result of this program is shown below. Without using window functions, users have to find all highest revenue values of all categories and then join this derived data set with the original <em>productRevenue</em> table to calculate the revenue differences.</p>
<p><img class="aligncenter wp-image-4578" src="./Introducing Window Functions in Spark SQL_files/1-3.png" alt="1-3" width="400" height="287"></p>
<h2>Using Window Functions</h2>
<p>Spark SQL supports three kinds of window functions: ranking functions, analytic functions, and aggregate functions. The available ranking functions and analytic functions are summarized in the table below. For aggregate functions, users can use any existing aggregate function as a window function.</p>
<table class="table">
<tbody>
<tr>
<td></td>
<td><strong>SQL</strong></td>
<td><strong>DataFrame API</strong></td>
</tr>
<tr>
<td rowspan="5"><strong>Ranking functions</strong></td>
<td>rank</td>
<td>rank</td>
</tr>
<tr>
<td>dense_rank</td>
<td>denseRank</td>
</tr>
<tr>
<td>percent_rank</td>
<td>percentRank</td>
</tr>
<tr>
<td>ntile</td>
<td>ntile</td>
</tr>
<tr>
<td>row_number</td>
<td>rowNumber</td>
</tr>
<tr>
<td rowspan="5"><strong>Analytic functions</strong></td>
<td>cume_dist</td>
<td>cumeDist</td>
</tr>
<tr>
<td>first_value</td>
<td>firstValue</td>
</tr>
<tr>
<td>last_value</td>
<td>lastValue</td>
</tr>
<tr>
<td>lag</td>
<td>lag</td>
</tr>
<tr>
<td>lead</td>
<td>lead</td>
</tr>
</tbody>
</table>
<p>To use window functions, users need to mark that a function is used as a window function by either</p>
<ul>
<li>Adding an <i>OVER</i> clause after a supported function in SQL, e.g. <code>avg(revenue) OVER (...)</code>; or</li>
<li>Calling the <i>over</i> method on a supported function in the DataFrame API, e.g. <code>rank().over(...)</code><i>.</i></li>
</ul>
<p>Once a function is marked as a window function, the next key step is to define the <i>Window Specification </i>associated with this function. A window specification defines which rows are included in the frame associated with a given input row. A window specification includes three parts:</p>
<ol>
<li>Partitioning Specification: controls which rows will be in the same partition with the given row. Also, the user might want to make sure all rows having the same value for &nbsp;the category column are collected to the same machine before ordering and calculating the frame. &nbsp;If no partitioning specification is given, then all data must be collected to a single machine.</li>
<li>Ordering Specification: controls the way that rows in a partition are ordered, determining the position of the given row in its partition.</li>
<li>Frame Specification: states which rows will be included in the frame for the current input row, based on their relative position to the current row. &nbsp;For example, “the three rows preceding the current row to the current row” describes a frame including the current input row and three rows appearing before the current row.</li>
</ol>
<p>In SQL, the <code>PARTITION BY</code> and <code>ORDER BY</code> keywords are used to specify partitioning expressions for the partitioning specification, and ordering expressions for the ordering specification, respectively. The SQL syntax is shown below.</p>
<p><code>OVER (PARTITION BY ... ORDER BY ...)</code></p>
<p>In the DataFrame API, we provide utility functions to define a window specification. Taking Python as an example, users can specify partitioning expressions and ordering expressions as follows.</p>
<div style="background: #f8f8f8; overflow: auto; width: auto;">
<pre style="margin: 0; line-height: 125%;"><span style="color: #aa22ff; font-weight: bold;">from</span> <span style="color: #0000ff; font-weight: bold;">pyspark.sql.window</span> <span style="color: #aa22ff; font-weight: bold;">import</span> Window

windowSpec <span style="color: #666666;">=</span> \
  Window \
    <span style="color: #666666;">.</span>partitionBy(<span style="color: #666666;">...</span>) \
    <span style="color: #666666;">.</span>orderBy(<span style="color: #666666;">...</span>)
</pre>
</div>
<p>&nbsp;</p>
<p>In addition to the ordering and partitioning, users need to define the start boundary of the frame, the end boundary of the frame, and the type of the frame, which are three components of a frame specification.</p>
<p>There are five types of boundaries, which are<code> UNBOUNDED PRECEDING</code>, <code>UNBOUNDED FOLLOWING</code>, <code>CURRENT ROW</code>, <code>&lt;value&gt; PRECEDING</code>, and <code>&lt;value&gt; FOLLOWING</code>. <code>UNBOUNDED PRECEDING</code> and <code>UNBOUNDED FOLLOWING</code> represent the first row of the partition and the last row of the partition, respectively. For the other three types of boundaries, they specify the offset from the position of the current input row and their specific meanings are defined based on the type of the frame. There are two types of frames, <i>ROW</i> frame and <i>RANGE</i> frame.</p>
<p><b>ROW frame</b></p>
<p>ROW frames are based on physical offsets from the position of the current input row, which means that <code>CURRENT ROW</code>, <code>&lt;value&gt; PRECEDING</code>, or <code>&lt;value&gt; FOLLOWING</code> specifies a physical offset. If <code>CURRENT ROW</code> is used as a boundary, it represents the current input row. <code>&lt;value&gt; PRECEDING</code> and <code>&lt;value&gt; FOLLOWING</code> describes the number of rows appear before and after the current input row, respectively. The following figure illustrates a ROW frame with a<code> 1 PRECEDING</code> as the start boundary and <code>1 FOLLOWING</code> as the end boundary (<code>ROWS BETWEEN 1 PRECEDING AND 1 FOLLOWING</code> in the SQL syntax).</p>
<p><img class="aligncenter wp-image-4581" src="./Introducing Window Functions in Spark SQL_files/2-1-1024x338.png" alt="2-1" width="700" height="231"></p>
<p><b>RANGE frame</b></p>
<p>RANGE frames are based on logical offsets from the position of the current input row, and have similar syntax to the ROW frame. A logical offset is the difference between the value of the ordering expression of the current input row and the value of that same expression of the boundary row of the frame. Because of this definition, when a RANGE frame is used, only a single ordering expression is allowed. Also, for a RANGE frame, all rows having the same value of the ordering expression with the current input row are considered as same row as far as the boundary calculation is concerned.</p>
<p>Now, let’s take a look at an example. In this example, the ordering expressions is <code>revenue</code>; the start boundary is <code>2000 PRECEDING</code>; and the end boundary is <code>1000 FOLLOWING</code> (this frame is defined as <code>RANGE BETWEEN 2000 PRECEDING AND 1000 FOLLOWING</code> in the SQL syntax). The following five figures illustrate how the frame is updated with the update of the current input row. Basically, for every current input row, based on the value of revenue, we calculate the revenue range <code>[current revenue value - 2000, current revenue value + 1000]</code>. All rows whose revenue values fall in this range are in the frame of the current input row.</p>
<p><img class="aligncenter wp-image-4582" src="./Introducing Window Functions in Spark SQL_files/2-2-1024x369.png" alt="2-2" width="700" height="252"></p>
<p><img class=" wp-image-4583 aligncenter" src="./Introducing Window Functions in Spark SQL_files/2-3-1024x263.png" alt="2-3" width="700" height="180"></p>
<p><img class=" wp-image-4584 aligncenter" src="./Introducing Window Functions in Spark SQL_files/2-4-1024x263.png" alt="2-4" width="700" height="180"></p>
<p><img class="aligncenter wp-image-4585" src="./Introducing Window Functions in Spark SQL_files/2-5-1024x263.png" alt="2-5" width="700" height="180"></p>
<p><img class="aligncenter wp-image-4586" src="./Introducing Window Functions in Spark SQL_files/2-6-1024x263.png" alt="2-6" width="700" height="180"></p>
<p>In summary, to define a window specification, users can use the following syntax in SQL.</p>
<p><code>OVER (PARTITION BY ... ORDER BY ... frame_type BETWEEN start AND end)</code></p>
<p>Here, <code>frame_type</code> can be either ROWS (for ROW frame) or RANGE (for RANGE frame); <code>start</code> can be any of <code>UNBOUNDED PRECEDING</code>, <code>CURRENT ROW</code>, <code>&lt;value&gt; PRECEDING</code>, and <code>&lt;value&gt; FOLLOWING</code>; and <code>end</code> can be any of <code>UNBOUNDED FOLLOWING</code>, <code>CURRENT ROW</code>, <code>&lt;value&gt; PRECEDING</code>, and <code>&lt;value&gt; FOLLOWING.</code></p>
<p>In the Python DataFrame API, users can define a window specification as follows.</p>
<div style="background: #f8f8f8; overflow: auto; width: auto;">
<pre style="margin: 0; line-height: 125%;"><span style="color: #aa22ff; font-weight: bold;">from</span> <span style="color: #0000ff; font-weight: bold;">pyspark.sql.window</span> <span style="color: #aa22ff; font-weight: bold;">import</span> Window

<span style="color: #008800; font-style: italic;"># Defines partitioning specification and ordering specification.</span>
windowSpec <span style="color: #666666;">=</span> \
  Window \
    <span style="color: #666666;">.</span>partitionBy(<span style="color: #666666;">...</span>) \
    <span style="color: #666666;">.</span>orderBy(<span style="color: #666666;">...</span>)
<span style="color: #008800; font-style: italic;"># Defines a Window Specification with a ROW frame.</span>
windowSpec<span style="color: #666666;">.</span>rowsBetween(start, end)
<span style="color: #008800; font-style: italic;"># Defines a Window Specification with a RANGE frame.</span>
windowSpec<span style="color: #666666;">.</span>rangeBetween(start, end)
</pre>
</div>
<h2></h2>
<h2>What’s next?</h2>
<p>Since the release of Spark 1.4, we have been actively working with community members on optimizations that improve the performance and reduce the memory consumption of the operator evaluating window functions. Some of these will be added in Spark 1.5, and others will be added in our future releases. Besides performance improvement work, there are two features that we will add in the near future to make window function support in Spark SQL even more powerful. First, we have been working on adding Interval data type support for Date and Timestamp data types (<a href="https://issues.apache.org/jira/browse/SPARK-8943">SPARK-8943</a>). With the Interval data type, users can use intervals as values specified in <code>&lt;value&gt; PRECEDING</code> and <code>&lt;value&gt; FOLLOWING</code> for RANGE frame, which makes it much easier to do various time series analysis with window functions. Second, we have been working on adding the support for user-defined aggregate functions in Spark SQL (<a href="https://issues.apache.org/jira/browse/SPARK-3947">SPARK-3947</a>). With our window function support, users can immediately use their user-defined aggregate functions as window functions to conduct various advanced data analysis tasks.</p>
<h2>Acknowledgements</h2>
<p>The development of the window function support in Spark 1.4 is is a joint work by many members of the Spark community. In particular, we would like to thank Wei Guo for contributing the initial patch.</p>
    </div>
  </div>
          <div class="blog-pagination-nav">
                          <a href="https://databricks.com/blog" class="h-link-back back-to-archive-link">Back to the Blog Archive</a>
                      </div>
                </div>
    </div>

        <div class="col-sidebar col-sm-3 col-lg-2">
      <div class="blog-sidebar">
  <div class="blog-sidebar-section blog-sidebar-section-navigation">
    <div class="blog-navigation">
    <div class="blog-navigation-section blog-navigation-section-company">
    <h4 class="blog-navigation-section-title">Company</h4>
    <ul id="menu-company-blog-links" class="blog-navigation-menu-items"><li id="menu-item-1845" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-1845"><a href="https://databricks.com/blog/category/company-blog">All Posts</a></li>
<li id="menu-item-1846" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-1846"><a href="https://databricks.com/blog/category/company/partners">Partners</a></li>
<li id="menu-item-1847" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-1847"><a href="https://databricks.com/blog/category/company/events">Events</a></li>
<li id="menu-item-1844" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-1844"><a href="https://databricks.com/blog/category/pressreleases">Press Releases</a></li>
</ul>  </div>
  
    <div class="blog-navigation-section blog-navigation-section-developer">
    <h4 class="blog-navigation-section-title">Developer</h4>
    <ul id="menu-developer-blog-links" class="blog-navigation-menu-items"><li id="menu-item-1848" class="menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor current-menu-parent current-post-parent menu-item-1848"><a href="https://databricks.com/blog/category/developer">All Posts</a></li>
<li id="menu-item-1852" class="menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor current-menu-parent current-post-parent menu-item-1852"><a href="https://databricks.com/blog/category/coding/spark">Spark</a></li>
<li id="menu-item-1850" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-1850"><a href="https://databricks.com/blog/category/sparksql">Spark SQL</a></li>
<li id="menu-item-1849" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-1849"><a href="https://databricks.com/blog/category/sparkstreaming">Spark Streaming</a></li>
<li id="menu-item-1853" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-1853"><a href="https://databricks.com/blog/category/coding/mllib">MLlib</a></li>
<li id="menu-item-1851" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-1851"><a href="https://databricks.com/blog/category/sparksummit">Spark Summit</a></li>
</ul>  </div>
  </div>
  </div>

  <div class="blog-sidebar-section blog-sidebar-section-search">
    <div class="snippet_search_form">
<form class="form form-search" action="https://databricks.com/" method="get">
    <div class="form-group">
    <label class="form-search-label" for="search-3">Search</label>
    <input class="form-search-field form-control" type="text" name="s" id="search-3" placeholder="Search Blog">
  </div>
  <button class="form-search-submit btn" type="submit">
    <span class="form-search-submit-text">Search</span>
  </button>
</form>
</div>  </div>

  <div class="blog-sidebar-section blog-sidebar-section-subscribe">
    Subscribe

    <ul class="blog-sidebar-section-subscribe-icons navbar-share">
      <li>
        <a href="https://twitter.com/databricks" target="_blank">
          <span class="db-icon-twitter"></span>
          <span class="sr-only">Databricks Twitter profile</span>
        </a>
      </li>
      <li>
        <a href="https://databricks.com/feed" title="Databricks Blog RSS feed" target="_blank">
          <span class="db-icon-rss"></span>
          <span class="sr-only">Databricks Blog RSS feed</span>
        </a>
      </li>
    </ul>
  </div>

  </div>
    </div>
      </div>
</div>
</div></div><!-- .body-content -->

<div class="body-footer container">
  <div class="footer-inner">
    <div class="row">
      <div class="col-sm-3 col_widget_nav_menu"><div class="col-inner"><div id="nav_menu-2" class="widget widget_nav_menu"><div class="menu-site-menu-container"><ul id="menu-site-menu-1" class="menu"><li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-2322"><a href="https://databricks.com/product">Product</a>
<ul class="sub-menu">
	<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-31"><a href="https://databricks.com/product/databricks">Databricks</a></li>
	<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-5851"><a href="https://databricks.com/product/pricing">Pricing</a></li>
	<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4871"><a href="https://databricks.com/product/security">Security</a></li>
	<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-30"><a href="https://databricks.com/product/faq">FAQ</a></li>
	<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-4032"><a href="https://forums.databricks.com/">Forums</a></li>
	<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4839"><a href="https://databricks.com/academic">Academic Program</a></li>
</ul>
</li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-145"><a href="https://databricks.com/spark">Spark</a>
<ul class="sub-menu">
	<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-147"><a href="https://databricks.com/spark/about">About Spark</a></li>
	<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-4688"><a href="http://sparkhub.databricks.com/">SparkHub (Community)</a></li>
	<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2169"><a href="https://databricks.com/spark/developer-resources">Developer Resources</a></li>
	<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-172"><a href="https://databricks.com/spark/certification">Certification</a></li>
	<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-261"><a href="https://databricks.com/spark/training">Training</a></li>
</ul>
</li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-4064"><a href="https://databricks.com/solutions">Solutions</a>
<ul class="sub-menu">
	<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4066"><a href="https://databricks.com/solutions/by-role">By Role</a></li>
	<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4065"><a href="https://databricks.com/solutions/by-industry">By Industry</a></li>
	<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4067"><a href="https://databricks.com/solutions/by-use-case">By Use Case</a></li>
</ul>
</li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-5441"><a href="https://databricks.com/customers">Customers</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-256"><a href="https://databricks.com/company">Company</a>
<ul class="sub-menu">
	<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-258"><a href="https://databricks.com/company/about-us">About Us</a></li>
	<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-6055"><a href="https://databricks.com/company/leadership-team">Leadership</a></li>
	<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2109"><a href="https://databricks.com/company/team">Team</a></li>
	<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-5835"><a href="https://databricks.com/company/partners">Partners</a></li>
	<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-3811"><a href="https://databricks.com/company/newsroom">Newsroom</a></li>
	<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4249"><a href="https://databricks.com/company/careers">Careers</a></li>
	<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-260"><a href="https://databricks.com/company/contact">Contact</a></li>
</ul>
</li>
<li class="menu-item menu-item-type-post_type menu-item-object-page current_page_parent menu-item-217"><a href="https://databricks.com/blog">Blog</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-4081"><a href="https://databricks.com/resources">Resources</a>
<ul class="sub-menu">
	<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4159"><a href="https://databricks.com/resources/analyst-reports">Analyst Reports</a></li>
	<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4082"><a href="https://databricks.com/resources/briefs">Briefs</a></li>
	<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4083"><a href="https://databricks.com/resources/case-studies">Case Studies</a></li>
	<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4084"><a href="https://databricks.com/resources/newsletters">Newsletters</a></li>
	<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-5477"><a href="https://databricks.com/resources/selected-notebooks">Selected Notebooks</a></li>
	<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4085"><a href="https://databricks.com/resources/slides">Slides</a></li>
	<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-5210"><a href="https://databricks.com/resources/surveys">Surveys</a></li>
	<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4086"><a href="https://databricks.com/resources/videos">Videos</a></li>
	<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4777"><a href="https://databricks.com/resources/webinars">Webinars</a></li>
</ul>
</li>
</ul></div></div></div></div><div class="col-sm-3 col_widget_text"><div class="col-inner"><div id="text-3" class="widget widget_text">			<div class="textwidget"><p>Databricks Inc.<br>
160 Spear Street, 13th Floor<br>
San Francisco, CA 94105</p>
<p><a href="mailto:info@databricks.com">info@databricks.com</a><br>
1-866-330-0121</p>
</div>
		</div></div></div>    </div>
    <div class="footer-copyright">
      <div class="row row-rtl">
        <div class="col-sm-3">
          <div class="col-inner">
            <ul class="company-social-links navbar-share">
              <li>
                <a href="https://twitter.com/databricks" target="_blank">
                  <span class="db-icon-twitter"></span>
                  <span class="sr-only">Databricks Twitter profile</span>
                </a>
              </li>
              <li>
                <a href="https://www.linkedin.com/company/databricks" target="_blank">
                  <span class="db-icon-linkedin"></span>
                  <span class="sr-only">Databricks LinkedIn profile</span>
                </a>
              </li>
              <li>
                <a href="https://www.facebook.com/pages/Databricks/560203607379694" target="_blank">
                  <span class="db-icon-facebook"></span>
                  <span class="sr-only">Databricks Facebook profile</span>
                </a>
              </li>

              <li>
                <a href="https://databricks.com/feed" target="_blank">
                  <span class="db-icon-rss"></span>
                  <span class="sr-only">Databricks Blog RSS feed</span>
                </a>
              </li>
            </ul>
          </div>
        </div>

        <div class="col-sm-9">
          <div class="col-inner">
            <p id="copyright" class="copyright-text">© Databricks 2016. All rights reserved. Apache Spark and the Apache Spark Logo are trademarks of the Apache Software Foundation. <a href="https://databricks.com/privacy-policy">Privacy Policy</a></p>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<div id="su-footer-links" style="text-align: center;"></div><script type="text/javascript" src="./Introducing Window Functions in Spark SQL_files/vendor.js"></script>
<script type="text/javascript" src="./Introducing Window Functions in Spark SQL_files/main.js"></script>
<script type="text/javascript" src="./Introducing Window Functions in Spark SQL_files/external-tracking.min.js"></script>
<script type="text/javascript" src="./Introducing Window Functions in Spark SQL_files/wp-embed.min.js"></script>

<!-- Google Tag Manager -->
<noscript>&lt;iframe src="//www.googletagmanager.com/ns.html?id=GTM-TWTKQQ"
height="0" width="0" style="display:none;visibility:hidden"&gt;&lt;/iframe&gt;</noscript>
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-TWTKQQ');</script>
<!-- End Google Tag Manager -->

<script type="text/javascript">window.NREUM||(NREUM={});NREUM.info={"beacon":"bam.nr-data.net","licenseKey":"cc545fdb66","applicationID":"6839999","transactionName":"NgdbNxRUDBFYVxBYWA9NbBEPGk0LV1ABSRkRCkk=","queueTime":0,"applicationTime":459,"ttGuid":"","agentToken":"","atts":"GkBYQVxOHx8=","errorBeacon":"bam.nr-data.net","agent":""}</script>

<div class="email-tab" id="email-box-102">
      <div class="email-tab-header"><button class="email-tab-toggle js-email-tab-toggle">Stay up to date on Spark.</button><button class="email-tab-close js-email-tab-close">
          <span class="sr-only">Close</span>
          <span class="email-tab-close-label">×</span>
        </button></div>
      <div class="email-tab-body js-email-tab-body">
        <p>Get the latest Spark news delivered right to your inbox.</p>
        <div class="email-tab-form js-email-tab-form"></div>
      </div>
    </div>
<script type="text/javascript" id="">(function(a,b,c,d,e){a=b.createElement(c);b=b.getElementsByTagName(c)[0];a.async=1;a.id=e;a.src=("https:"==document.location.protocol?"https://":"http://")+d;b.parentNode.insertBefore(a,b)})(window,document,"script","scripts.demandbase.com/xoRL8eto.min.js","demandbase_js_lib");</script><div style="display: none; visibility: hidden;"><script type="text/javascript">(function(a,c,d,e){if(!a.getElementById(d)){var b=a.createElement(c);a=a.getElementsByTagName(c)[0];b.id=d;b.src="//js.hs-analytics.net/analytics/"+Math.ceil(new Date/e)*e+"/438089.js";a.parentNode.insertBefore(b,a)}})(document,"script","hs-analytics",3E5);</script></div><script type="text/javascript" id="" src="./Introducing Window Functions in Spark SQL_files/oct.js"></script>
<script type="text/javascript" id="">!function(b,e,f,g,a,c,d){b.fbq||(a=b.fbq=function(){a.callMethod?a.callMethod.apply(a,arguments):a.queue.push(arguments)},b._fbq||(b._fbq=a),a.push=a,a.loaded=!0,a.version="2.0",a.queue=[],c=e.createElement(f),c.async=!0,c.src=g,d=e.getElementsByTagName(f)[0],d.parentNode.insertBefore(c,d))}(window,document,"script","//connect.facebook.net/en_US/fbevents.js");fbq("init","1723158351253812");fbq("track","PageView");</script>
<noscript>&lt;img height="1" width="1" style="display:none" src="https://www.facebook.com/tr?id=1723158351253812&amp;amp;ev=PageView&amp;amp;noscript=1"&gt;</noscript>

<script type="text/javascript" id="">twttr.conversion.trackPid("ntgt2",{tw_sale_amount:0,tw_order_quantity:0});</script>
<noscript>
  &lt;img height="1" width="1" style="display:none;" alt="" src="https://analytics.twitter.com/i/adsct?txn_id=ntgt2&amp;amp;p_id=Twitter&amp;amp;tw_sale_amount=0&amp;amp;tw_order_quantity=0"&gt;
  &lt;img height="1" width="1" style="display:none;" alt="" src="//t.co/i/adsct?txn_id=ntgt2&amp;amp;p_id=Twitter&amp;amp;tw_sale_amount=0&amp;amp;tw_order_quantity=0"&gt;
</noscript></body></html>